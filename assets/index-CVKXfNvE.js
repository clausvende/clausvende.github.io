`&&(r=r.substr(1),nt=1),T+A+(R=(a=cp.apply(this,[r,e])).reduce(function(At,bt){return At+bt},0))>t||nt){if(R>t){for(f=Ov.apply(this,[r,a,t-(T+A),t]),_.push(f.shift()),_=[f.pop()];f.length;)S.push([f.shift()]);R=a.slice(r.length-(_[0]?_[0].length:0)).reduce(function(At,bt){return At+bt},0)}else _=[r];S.push(_),T=R+p,A=H}else _.push(r),T+=A+R,A=H}return y=p?function(At,bt){return(bt?j:"")+At.join(" ")}:function(At){return At.join(" ")},S.map(y)},eh.splitTextToSize=function(i,t,e){var r,a=(e=e||{}).fontSize||this.internal.getFontSize(),l=(function(_){if(_.widths&&_.kerning)return{widths:_.widths,kerning:_.kerning};var S=this.internal.getFont(_.fontName,_.fontStyle);return S.metadata.Unicode?{widths:S.metadata.Unicode.widths||{0:1},kerning:S.metadata.Unicode.kerning||{}}:{font:S.metadata,fontSize:this.internal.getFontSize(),charSpace:this.internal.getCharSpace()}}).call(this,e);r=Array.isArray(i)?i:String(i).split(/\r?\n/);var c=1*this.internal.scaleFactor*t/a;l.textIndent=e.textIndent?1*e.textIndent*this.internal.scaleFactor/a:0,l.lineIndent=e.lineIndent;var f,p,y=[];for(f=0,p=r.length;f<p;f++)y=y.concat(Mv.apply(this,[r[f],c,l]));return y},function(i){i.__fontmetrics__=i.__fontmetrics__||{};for(var t="klmnopqrstuvwxyz",e={},r={},a=0;a<t.length;a++)e[t[a]]="0123456789abcdef"[a],r["0123456789abcdef"[a]]=t[a];var l=function(S){return"0x"+parseInt(S,10).toString(16)},c=i.__fontmetrics__.compress=function(S){var T,A,R,V,H=["{"];for(var j in S){if(T=S[j],isNaN(parseInt(j,10))?A="'"+j+"'":(j=parseInt(j,10),A=(A=l(j).slice(2)).slice(0,-1)+r[A.slice(-1)]),typeof T=="number")T<0?(R=l(T).slice(3),V="-"):(R=l(T).slice(2),V=""),R=V+R.slice(0,-1)+r[R.slice(-1)];else{if(kn(T)!=="object")throw new Error("Don't know what to do with value type "+kn(T)+".");R=c(T)}H.push(A+R)}return H.push("}"),H.join("")},f=i.__fontmetrics__.uncompress=function(S){if(typeof S!="string")throw new Error("Invalid argument passed to uncompress.");for(var T,A,R,V,H={},j=1,X=H,nt=[],At="",bt="",kt=S.length-1,W=1;W<kt;W+=1)(V=S[W])=="'"?T?(R=T.join(""),T=void 0):T=[]:T?T.push(V):V=="{"?(nt.push([X,R]),X={},R=void 0):V=="}"?((A=nt.pop())[0][A[1]]=X,R=void 0,X=A[0]):V=="-"?j=-1:R===void 0?e.hasOwnProperty(V)?(At+=e[V],R=parseInt(At,16)*j,j=1,At=""):At+=V:e.hasOwnProperty(V)?(bt+=e[V],X[R]=parseInt(bt,16)*j,j=1,R=void 0,bt=""):bt+=V;return H},p={codePages:["WinAnsiEncoding"],WinAnsiEncoding:f("{19m8n201n9q201o9r201s9l201t9m201u8m201w9n201x9o201y8o202k8q202l8r202m9p202q8p20aw8k203k8t203t8v203u9v2cq8s212m9t15m8w15n9w2dw9s16k8u16l9u17s9z17x8y17y9y}")},y={Unicode:{Courier:p,"Courier-Bold":p,"Courier-BoldOblique":p,"Courier-Oblique":p,Helvetica:p,"Helvetica-Bold":p,"Helvetica-BoldOblique":p,"Helvetica-Oblique":p,"Times-Roman":p,"Times-Bold":p,"Times-BoldItalic":p,"Times-Italic":p}},_={Unicode:{"Courier-Oblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-BoldItalic":f("{'widths'{k3o2q4ycx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2r202m2n2n3m2o3m2p5n202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5n4l4m4m4m4n4m4o4s4p4m4q4m4r4s4s4y4t2r4u3m4v4m4w3x4x5t4y4s4z4s5k3x5l4s5m4m5n3r5o3x5p4s5q4m5r5t5s4m5t3x5u3x5v2l5w1w5x2l5y3t5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q2l6r3m6s3r6t1w6u1w6v3m6w1w6x4y6y3r6z3m7k3m7l3m7m2r7n2r7o1w7p3r7q2w7r4m7s3m7t2w7u2r7v2n7w1q7x2n7y3t202l3mcl4mal2ram3man3mao3map3mar3mas2lat4uau1uav3maw3way4uaz2lbk2sbl3t'fof'6obo2lbp3tbq3mbr1tbs2lbu1ybv3mbz3mck4m202k3mcm4mcn4mco4mcp4mcq5ycr4mcs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz2w203k6o212m6o2dw2l2cq2l3t3m3u2l17s3x19m3m}'kerning'{cl{4qu5kt5qt5rs17ss5ts}201s{201ss}201t{cks4lscmscnscoscpscls2wu2yu201ts}201x{2wu2yu}2k{201ts}2w{4qx5kx5ou5qx5rs17su5tu}2x{17su5tu5ou}2y{4qx5kx5ou5qx5rs17ss5ts}'fof'-6ofn{17sw5tw5ou5qw5rs}7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qs}3v{17su5tu5os5qs}7p{17su5tu}ck{4qu5kt5qt5rs17ss5ts}4l{4qu5kt5qt5rs17ss5ts}cm{4qu5kt5qt5rs17ss5ts}cn{4qu5kt5qt5rs17ss5ts}co{4qu5kt5qt5rs17ss5ts}cp{4qu5kt5qt5rs17ss5ts}6l{4qu5ou5qw5rt17su5tu}5q{ckuclucmucnucoucpu4lu}5r{ckuclucmucnucoucpu4lu}7q{cksclscmscnscoscps4ls}6p{4qu5ou5qw5rt17sw5tw}ek{4qu5ou5qw5rt17su5tu}el{4qu5ou5qw5rt17su5tu}em{4qu5ou5qw5rt17su5tu}en{4qu5ou5qw5rt17su5tu}eo{4qu5ou5qw5rt17su5tu}ep{4qu5ou5qw5rt17su5tu}es{17ss5ts5qs4qu}et{4qu5ou5qw5rt17sw5tw}eu{4qu5ou5qw5rt17ss5ts}ev{17ss5ts5qs4qu}6z{17sw5tw5ou5qw5rs}fm{17sw5tw5ou5qw5rs}7n{201ts}fo{17sw5tw5ou5qw5rs}fp{17sw5tw5ou5qw5rs}fq{17sw5tw5ou5qw5rs}7r{cksclscmscnscoscps4ls}fs{17sw5tw5ou5qw5rs}ft{17su5tu}fu{17su5tu}fv{17su5tu}fw{17su5tu}fz{cksclscmscnscoscps4ls}}}"),"Helvetica-Bold":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),Courier:f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-BoldOblique":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Bold":f("{'widths'{k3q2q5ncx2r201n3m201o6o201s2l201t2l201u2l201w3m201x3m201y3m2k1t2l2l202m2n2n3m2o3m2p6o202q6o2r1w2s2l2t2l2u3m2v3t2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w3t3x3t3y3t3z3m4k5x4l4s4m4m4n4s4o4s4p4m4q3x4r4y4s4y4t2r4u3m4v4y4w4m4x5y4y4s4z4y5k3x5l4y5m4s5n3r5o4m5p4s5q4s5r6o5s4s5t4s5u4m5v2l5w1w5x2l5y3u5z3m6k2l6l3m6m3r6n2w6o3r6p2w6q2l6r3m6s3r6t1w6u2l6v3r6w1w6x5n6y3r6z3m7k3r7l3r7m2w7n2r7o2l7p3r7q3m7r4s7s3m7t3m7u2w7v2r7w1q7x2r7y3o202l3mcl4sal2lam3man3mao3map3mar3mas2lat4uau1yav3maw3tay4uaz2lbk2sbl3t'fof'6obo2lbp3rbr1tbs2lbu2lbv3mbz3mck4s202k3mcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw2r2m3rcy2rcz2rdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3rek3mel3mem3men3meo3mep3meq4ser2wes2wet2weu2wev2wew1wex1wey1wez1wfl3rfm3mfn3mfo3mfp3mfq3mfr3tfs3mft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3m3u2l17s4s19m3m}'kerning'{cl{4qt5ks5ot5qy5rw17sv5tv}201t{cks4lscmscnscoscpscls4wv}2k{201ts}2w{4qu5ku7mu5os5qx5ru17su5tu}2x{17su5tu5ou5qs}2y{4qv5kv7mu5ot5qz5ru17su5tu}'fof'-6o7t{cksclscmscnscoscps4ls}3u{17su5tu5os5qu}3v{17su5tu5os5qu}fu{17su5tu5ou5qu}7p{17su5tu5ou5qu}ck{4qt5ks5ot5qy5rw17sv5tv}4l{4qt5ks5ot5qy5rw17sv5tv}cm{4qt5ks5ot5qy5rw17sv5tv}cn{4qt5ks5ot5qy5rw17sv5tv}co{4qt5ks5ot5qy5rw17sv5tv}cp{4qt5ks5ot5qy5rw17sv5tv}6l{17st5tt5ou5qu}17s{ckuclucmucnucoucpu4lu4wu}5o{ckuclucmucnucoucpu4lu4wu}5q{ckzclzcmzcnzcozcpz4lz4wu}5r{ckxclxcmxcnxcoxcpx4lx4wu}5t{ckuclucmucnucoucpu4lu4wu}7q{ckuclucmucnucoucpu4lu}6p{17sw5tw5ou5qu}ek{17st5tt5qu}el{17st5tt5ou5qu}em{17st5tt5qu}en{17st5tt5qu}eo{17st5tt5qu}ep{17st5tt5ou5qu}es{17ss5ts5qu}et{17sw5tw5ou5qu}eu{17sw5tw5ou5qu}ev{17ss5ts5qu}6z{17sw5tw5ou5qu5rs}fm{17sw5tw5ou5qu5rs}fn{17sw5tw5ou5qu5rs}fo{17sw5tw5ou5qu5rs}fp{17sw5tw5ou5qu5rs}fq{17sw5tw5ou5qu5rs}7r{cktcltcmtcntcotcpt4lt5os}fs{17sw5tw5ou5qu5rs}ft{17su5tu5ou5qu}7m{5os}fv{17su5tu5ou5qu}fw{17su5tu5ou5qu}fz{cksclscmscnscoscps4ls}}}"),Symbol:f("{'widths'{k3uaw4r19m3m2k1t2l2l202m2y2n3m2p5n202q6o3k3m2s2l2t2l2v3r2w1t3m3m2y1t2z1wbk2sbl3r'fof'6o3n3m3o3m3p3m3q3m3r3m3s3m3t3m3u1w3v1w3w3r3x3r3y3r3z2wbp3t3l3m5v2l5x2l5z3m2q4yfr3r7v3k7w1o7x3k}'kerning'{'fof'-6o}}"),Helvetica:f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}"),"Helvetica-BoldOblique":f("{'widths'{k3s2q4scx1w201n3r201o6o201s1w201t1w201u1w201w3m201x3m201y3m2k1w2l2l202m2n2n3r2o3r2p5t202q6o2r1s2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v2l3w3u3x3u3y3u3z3x4k6l4l4s4m4s4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3r4v4s4w3x4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v2l5w1w5x2l5y3u5z3r6k2l6l3r6m3x6n3r6o3x6p3r6q2l6r3x6s3x6t1w6u1w6v3r6w1w6x5t6y3x6z3x7k3x7l3x7m2r7n3r7o2l7p3x7q3r7r4y7s3r7t3r7u3m7v2r7w1w7x2r7y3u202l3rcl4sal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3xbq3rbr1wbs2lbu2obv3rbz3xck4s202k3rcm4scn4sco4scp4scq6ocr4scs4mct4mcu4mcv4mcw1w2m2zcy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3res3ret3reu3rev3rew1wex1wey1wez1wfl3xfm3xfn3xfo3xfp3xfq3xfr3ufs3xft3xfu3xfv3xfw3xfz3r203k6o212m6o2dw2l2cq2l3t3r3u2l17s4m19m3r}'kerning'{cl{4qs5ku5ot5qs17sv5tv}201t{2ww4wy2yw}201w{2ks}201x{2ww4wy2yw}2k{201ts201xs}2w{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}2x{5ow5qs}2y{7qs4qu5kw5os5qw5rs17su5tu7tsfzs}'fof'-6o7p{17su5tu5ot}ck{4qs5ku5ot5qs17sv5tv}4l{4qs5ku5ot5qs17sv5tv}cm{4qs5ku5ot5qs17sv5tv}cn{4qs5ku5ot5qs17sv5tv}co{4qs5ku5ot5qs17sv5tv}cp{4qs5ku5ot5qs17sv5tv}6l{17st5tt5os}17s{2kwclvcmvcnvcovcpv4lv4wwckv}5o{2kucltcmtcntcotcpt4lt4wtckt}5q{2ksclscmscnscoscps4ls4wvcks}5r{2ks4ws}5t{2kwclvcmvcnvcovcpv4lv4wwckv}eo{17st5tt5os}fu{17su5tu5ot}6p{17ss5ts}ek{17st5tt5os}el{17st5tt5os}em{17st5tt5os}en{17st5tt5os}6o{201ts}ep{17st5tt5os}es{17ss5ts}et{17ss5ts}eu{17ss5ts}ev{17ss5ts}6z{17su5tu5os5qt}fm{17su5tu5os5qt}fn{17su5tu5os5qt}fo{17su5tu5os5qt}fp{17su5tu5os5qt}fq{17su5tu5os5qt}fs{17su5tu5os5qt}ft{17su5tu5ot}7m{5os}fv{17su5tu5ot}fw{17su5tu5ot}}}"),ZapfDingbats:f("{'widths'{k4u2k1w'fof'6o}'kerning'{'fof'-6o}}"),"Courier-Bold":f("{'widths'{k3w'fof'6o}'kerning'{'fof'-6o}}"),"Times-Italic":f("{'widths'{k3n2q4ycx2l201n3m201o5t201s2l201t2l201u2l201w3r201x3r201y3r2k1t2l2l202m2n2n3m2o3m2p5n202q5t2r1p2s2l2t2l2u3m2v4n2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v2l3w4n3x4n3y4n3z3m4k5w4l3x4m3x4n4m4o4s4p3x4q3x4r4s4s4s4t2l4u2w4v4m4w3r4x5n4y4m4z4s5k3x5l4s5m3x5n3m5o3r5p4s5q3x5r5n5s3x5t3r5u3r5v2r5w1w5x2r5y2u5z3m6k2l6l3m6m3m6n2w6o3m6p2w6q1w6r3m6s3m6t1w6u1w6v2w6w1w6x4s6y3m6z3m7k3m7l3m7m2r7n2r7o1w7p3m7q2w7r4m7s2w7t2w7u2r7v2s7w1v7x2s7y3q202l3mcl3xal2ram3man3mao3map3mar3mas2lat4wau1vav3maw4nay4waz2lbk2sbl4n'fof'6obo2lbp3mbq3obr1tbs2lbu1zbv3mbz3mck3x202k3mcm3xcn3xco3xcp3xcq5tcr4mcs3xct3xcu3xcv3xcw2l2m2ucy2lcz2ldl4mdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek3mel3mem3men3meo3mep3meq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr4nfs3mft3mfu3mfv3mfw3mfz2w203k6o212m6m2dw2l2cq2l3t3m3u2l17s3r19m3m}'kerning'{cl{5kt4qw}201s{201sw}201t{201tw2wy2yy6q-t}201x{2wy2yy}2k{201tw}2w{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}2x{17ss5ts5os}2y{7qs4qy7rs5ky7mw5os5qx5ru17su5tu}'fof'-6o6t{17ss5ts5qs}7t{5os}3v{5qs}7p{17su5tu5qs}ck{5kt4qw}4l{5kt4qw}cm{5kt4qw}cn{5kt4qw}co{5kt4qw}cp{5kt4qw}6l{4qs5ks5ou5qw5ru17su5tu}17s{2ks}5q{ckvclvcmvcnvcovcpv4lv}5r{ckuclucmucnucoucpu4lu}5t{2ks}6p{4qs5ks5ou5qw5ru17su5tu}ek{4qs5ks5ou5qw5ru17su5tu}el{4qs5ks5ou5qw5ru17su5tu}em{4qs5ks5ou5qw5ru17su5tu}en{4qs5ks5ou5qw5ru17su5tu}eo{4qs5ks5ou5qw5ru17su5tu}ep{4qs5ks5ou5qw5ru17su5tu}es{5ks5qs4qs}et{4qs5ks5ou5qw5ru17su5tu}eu{4qs5ks5qw5ru17su5tu}ev{5ks5qs4qs}ex{17ss5ts5qs}6z{4qv5ks5ou5qw5ru17su5tu}fm{4qv5ks5ou5qw5ru17su5tu}fn{4qv5ks5ou5qw5ru17su5tu}fo{4qv5ks5ou5qw5ru17su5tu}fp{4qv5ks5ou5qw5ru17su5tu}fq{4qv5ks5ou5qw5ru17su5tu}7r{5os}fs{4qv5ks5ou5qw5ru17su5tu}ft{17su5tu5qs}fu{17su5tu5qs}fv{17su5tu5qs}fw{17su5tu5qs}}}"),"Times-Roman":f("{'widths'{k3n2q4ycx2l201n3m201o6o201s2l201t2l201u2l201w2w201x2w201y2w2k1t2l2l202m2n2n3m2o3m2p5n202q6o2r1m2s2l2t2l2u3m2v3s2w1t2x2l2y1t2z1w3k3m3l3m3m3m3n3m3o3m3p3m3q3m3r3m3s3m203t2l203u2l3v1w3w3s3x3s3y3s3z2w4k5w4l4s4m4m4n4m4o4s4p3x4q3r4r4s4s4s4t2l4u2r4v4s4w3x4x5t4y4s4z4s5k3r5l4s5m4m5n3r5o3x5p4s5q4s5r5y5s4s5t4s5u3x5v2l5w1w5x2l5y2z5z3m6k2l6l2w6m3m6n2w6o3m6p2w6q2l6r3m6s3m6t1w6u1w6v3m6w1w6x4y6y3m6z3m7k3m7l3m7m2l7n2r7o1w7p3m7q3m7r4s7s3m7t3m7u2w7v3k7w1o7x3k7y3q202l3mcl4sal2lam3man3mao3map3mar3mas2lat4wau1vav3maw3say4waz2lbk2sbl3s'fof'6obo2lbp3mbq2xbr1tbs2lbu1zbv3mbz2wck4s202k3mcm4scn4sco4scp4scq5tcr4mcs3xct3xcu3xcv3xcw2l2m2tcy2lcz2ldl4sdm4sdn4sdo4sdp4sdq4sds4sdt4sdu4sdv4sdw4sdz3mek2wel2wem2wen2weo2wep2weq4mer2wes2wet2weu2wev2wew1wex1wey1wez1wfl3mfm3mfn3mfo3mfp3mfq3mfr3sfs3mft3mfu3mfv3mfw3mfz3m203k6o212m6m2dw2l2cq2l3t3m3u1w17s4s19m3m}'kerning'{cl{4qs5ku17sw5ou5qy5rw201ss5tw201ws}201s{201ss}201t{ckw4lwcmwcnwcowcpwclw4wu201ts}2k{201ts}2w{4qs5kw5os5qx5ru17sx5tx}2x{17sw5tw5ou5qu}2y{4qs5kw5os5qx5ru17sx5tx}'fof'-6o7t{ckuclucmucnucoucpu4lu5os5rs}3u{17su5tu5qs}3v{17su5tu5qs}7p{17sw5tw5qs}ck{4qs5ku17sw5ou5qy5rw201ss5tw201ws}4l{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cm{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cn{4qs5ku17sw5ou5qy5rw201ss5tw201ws}co{4qs5ku17sw5ou5qy5rw201ss5tw201ws}cp{4qs5ku17sw5ou5qy5rw201ss5tw201ws}6l{17su5tu5os5qw5rs}17s{2ktclvcmvcnvcovcpv4lv4wuckv}5o{ckwclwcmwcnwcowcpw4lw4wu}5q{ckyclycmycnycoycpy4ly4wu5ms}5r{cktcltcmtcntcotcpt4lt4ws}5t{2ktclvcmvcnvcovcpv4lv4wuckv}7q{cksclscmscnscoscps4ls}6p{17su5tu5qw5rs}ek{5qs5rs}el{17su5tu5os5qw5rs}em{17su5tu5os5qs5rs}en{17su5qs5rs}eo{5qs5rs}ep{17su5tu5os5qw5rs}es{5qs}et{17su5tu5qw5rs}eu{17su5tu5qs5rs}ev{5qs}6z{17sv5tv5os5qx5rs}fm{5os5qt5rs}fn{17sv5tv5os5qx5rs}fo{17sv5tv5os5qx5rs}fp{5os5qt5rs}fq{5os5qt5rs}7r{ckuclucmucnucoucpu4lu5os}fs{17sv5tv5os5qx5rs}ft{17ss5ts5qs}fu{17sw5tw5qs}fv{17sw5tw5qs}fw{17ss5ts5qs}fz{ckuclucmucnucoucpu4lu5os5rs}}}"),"Helvetica-Oblique":f("{'widths'{k3p2q4mcx1w201n3r201o6o201s1q201t1q201u1q201w2l201x2l201y2l2k1w2l1w202m2n2n3r2o3r2p5t202q6o2r1n2s2l2t2l2u2r2v3u2w1w2x2l2y1w2z1w3k3r3l3r3m3r3n3r3o3r3p3r3q3r3r3r3s3r203t2l203u2l3v1w3w3u3x3u3y3u3z3r4k6p4l4m4m4m4n4s4o4s4p4m4q3x4r4y4s4s4t1w4u3m4v4m4w3r4x5n4y4s4z4y5k4m5l4y5m4s5n4m5o3x5p4s5q4m5r5y5s4m5t4m5u3x5v1w5w1w5x1w5y2z5z3r6k2l6l3r6m3r6n3m6o3r6p3r6q1w6r3r6s3r6t1q6u1q6v3m6w1q6x5n6y3r6z3r7k3r7l3r7m2l7n3m7o1w7p3r7q3m7r4s7s3m7t3m7u3m7v2l7w1u7x2l7y3u202l3rcl4mal2lam3ran3rao3rap3rar3ras2lat4tau2pav3raw3uay4taz2lbk2sbl3u'fof'6obo2lbp3rbr1wbs2lbu2obv3rbz3xck4m202k3rcm4mcn4mco4mcp4mcq6ocr4scs4mct4mcu4mcv4mcw1w2m2ncy1wcz1wdl4sdm4ydn4ydo4ydp4ydq4yds4ydt4sdu4sdv4sdw4sdz3xek3rel3rem3ren3reo3rep3req5ter3mes3ret3reu3rev3rew1wex1wey1wez1wfl3rfm3rfn3rfo3rfp3rfq3rfr3ufs3xft3rfu3rfv3rfw3rfz3m203k6o212m6o2dw2l2cq2l3t3r3u1w17s4m19m3r}'kerning'{5q{4wv}cl{4qs5kw5ow5qs17sv5tv}201t{2wu4w1k2yu}201x{2wu4wy2yu}17s{2ktclucmucnu4otcpu4lu4wycoucku}2w{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}2x{17sy5ty5oy5qs}2y{7qs4qz5k1m17sy5ow5qx5rsfsu5ty7tufzu}'fof'-6o7p{17sv5tv5ow}ck{4qs5kw5ow5qs17sv5tv}4l{4qs5kw5ow5qs17sv5tv}cm{4qs5kw5ow5qs17sv5tv}cn{4qs5kw5ow5qs17sv5tv}co{4qs5kw5ow5qs17sv5tv}cp{4qs5kw5ow5qs17sv5tv}6l{17sy5ty5ow}do{17st5tt}4z{17st5tt}7s{fst}dm{17st5tt}dn{17st5tt}5o{ckwclwcmwcnwcowcpw4lw4wv}dp{17st5tt}dq{17st5tt}7t{5ow}ds{17st5tt}5t{2ktclucmucnu4otcpu4lu4wycoucku}fu{17sv5tv5ow}6p{17sy5ty5ow5qs}ek{17sy5ty5ow}el{17sy5ty5ow}em{17sy5ty5ow}en{5ty}eo{17sy5ty5ow}ep{17sy5ty5ow}es{17sy5ty5qs}et{17sy5ty5ow5qs}eu{17sy5ty5ow5qs}ev{17sy5ty5ow5qs}6z{17sy5ty5ow5qs}fm{17sy5ty5ow5qs}fn{17sy5ty5ow5qs}fo{17sy5ty5ow5qs}fp{17sy5ty5qs}fq{17sy5ty5ow5qs}7r{5ow}fs{17sy5ty5ow5qs}ft{17sv5tv5ow}7m{5ow}fv{17sv5tv5ow}fw{17sv5tv5ow}}}")}};i.events.push(["addFont",function(S){var T=S.font,A=_.Unicode[T.postScriptName];A&&(T.metadata.Unicode={},T.metadata.Unicode.widths=A.widths,T.metadata.Unicode.kerning=A.kerning);var R=y.Unicode[T.postScriptName];R&&(T.metadata.Unicode.encoding=R,T.encoding=R.codePages[0])}])}(Ce.API),function(i){var t=function(e){for(var r=e.length,a=new Uint8Array(r),l=0;l<r;l++)a[l]=e.charCodeAt(l);return a};i.API.events.push(["addFont",function(e){var r=void 0,a=e.font,l=e.instance;if(!a.isStandardFont){if(l===void 0)throw new Error("Font does not exist in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");if(typeof(r=l.existsFileInVFS(a.postScriptName)===!1?l.loadFile(a.postScriptName):l.getFileFromVFS(a.postScriptName))!="string")throw new Error("Font is not stored as string-data in vFS, import fonts or remove declaration doc.addFont('"+a.postScriptName+"').");(function(c,f){f=/^\x00\x01\x00\x00/.test(f)?t(f):t(Pf(f)),c.metadata=i.API.TTFFont.open(f),c.metadata.Unicode=c.metadata.Unicode||{encoding:{},kerning:{},widths:[]},c.metadata.glyIdsUsed=[0]})(a,r)}}])}(Ce),function(i){function t(){return(Me.canvg?Promise.resolve(Me.canvg):I0(()=>import("./index.es-DfCV43fV.js"),[])).catch(function(e){return Promise.reject(new Error("Could not load canvg: "+e))}).then(function(e){return e.default?e.default:e})}Ce.API.addSvgAsImage=function(e,r,a,l,c,f,p,y){if(isNaN(r)||isNaN(a))throw Yn.error("jsPDF.addSvgAsImage: Invalid coordinates",arguments),new Error("Invalid coordinates passed to jsPDF.addSvgAsImage");if(isNaN(l)||isNaN(c))throw Yn.error("jsPDF.addSvgAsImage: Invalid measurements",arguments),new Error("Invalid measurements (width and/or height) passed to jsPDF.addSvgAsImage");var _=document.createElement("canvas");_.width=l,_.height=c;var S=_.getContext("2d");S.fillStyle="#fff",S.fillRect(0,0,_.width,_.height);var T={ignoreMouse:!0,ignoreAnimation:!0,ignoreDimensions:!0},A=this;return t().then(function(R){return R.fromString(S,e,T)},function(){return Promise.reject(new Error("Could not load canvg."))}).then(function(R){return R.render(T)}).then(function(){A.addImage(_.toDataURL("image/jpeg",1),r,a,l,c,p,y)})}}(),Ce.API.putTotalPages=function(i){var t,e=0;parseInt(this.internal.getFont().id.substr(1),10)<15?(t=new RegExp(i,"g"),e=this.internal.getNumberOfPages()):(t=new RegExp(this.pdfEscape16(i,this.internal.getFont()),"g"),e=this.pdfEscape16(this.internal.getNumberOfPages()+"",this.internal.getFont()));for(var r=1;r<=this.internal.getNumberOfPages();r++)for(var a=0;a<this.internal.pages[r].length;a++)this.internal.pages[r][a]=this.internal.pages[r][a].replace(t,e);return this},Ce.API.viewerPreferences=function(i,t){var e;i=i||{},t=t||!1;var r,a,l,c={HideToolbar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideMenubar:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},HideWindowUI:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},FitWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},CenterWindow:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.3},DisplayDocTitle:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.4},NonFullScreenPageMode:{defaultValue:"UseNone",value:"UseNone",type:"name",explicitSet:!1,valueSet:["UseNone","UseOutlines","UseThumbs","UseOC"],pdfVersion:1.3},Direction:{defaultValue:"L2R",value:"L2R",type:"name",explicitSet:!1,valueSet:["L2R","R2L"],pdfVersion:1.3},ViewArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},ViewClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintArea:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintClip:{defaultValue:"CropBox",value:"CropBox",type:"name",explicitSet:!1,valueSet:["MediaBox","CropBox","TrimBox","BleedBox","ArtBox"],pdfVersion:1.4},PrintScaling:{defaultValue:"AppDefault",value:"AppDefault",type:"name",explicitSet:!1,valueSet:["AppDefault","None"],pdfVersion:1.6},Duplex:{defaultValue:"",value:"none",type:"name",explicitSet:!1,valueSet:["Simplex","DuplexFlipShortEdge","DuplexFlipLongEdge","none"],pdfVersion:1.7},PickTrayByPDFSize:{defaultValue:!1,value:!1,type:"boolean",explicitSet:!1,valueSet:[!0,!1],pdfVersion:1.7},PrintPageRange:{defaultValue:"",value:"",type:"array",explicitSet:!1,valueSet:null,pdfVersion:1.7},NumCopies:{defaultValue:1,value:1,type:"integer",explicitSet:!1,valueSet:null,pdfVersion:1.7}},f=Object.keys(c),p=[],y=0,_=0,S=0;function T(R,V){var H,j=!1;for(H=0;H<R.length;H+=1)R[H]===V&&(j=!0);return j}if(this.internal.viewerpreferences===void 0&&(this.internal.viewerpreferences={},this.internal.viewerpreferences.configuration=JSON.parse(JSON.stringify(c)),this.internal.viewerpreferences.isSubscribed=!1),e=this.internal.viewerpreferences.configuration,i==="reset"||t===!0){var A=f.length;for(S=0;S<A;S+=1)e[f[S]].value=e[f[S]].defaultValue,e[f[S]].explicitSet=!1}if(kn(i)==="object"){for(a in i)if(l=i[a],T(f,a)&&l!==void 0){if(e[a].type==="boolean"&&typeof l=="boolean")e[a].value=l;else if(e[a].type==="name"&&T(e[a].valueSet,l))e[a].value=l;else if(e[a].type==="integer"&&Number.isInteger(l))e[a].value=l;else if(e[a].type==="array"){for(y=0;y<l.length;y+=1)if(r=!0,l[y].length===1&&typeof l[y][0]=="number")p.push(String(l[y]-1));else if(l[y].length>1){for(_=0;_<l[y].length;_+=1)typeof l[y][_]!="number"&&(r=!1);r===!0&&p.push([l[y][0]-1,l[y][1]-1].join(" "))}e[a].value="["+p.join(" ")+"]"}else e[a].value=e[a].defaultValue;e[a].explicitSet=!0}}return this.internal.viewerpreferences.isSubscribed===!1&&(this.internal.events.subscribe("putCatalog",function(){var R,V=[];for(R in e)e[R].explicitSet===!0&&(e[R].type==="name"?V.push("/"+R+" /"+e[R].value):V.push("/"+R+" "+e[R].value));V.length!==0&&this.internal.write(`/ViewerPreferences
`)}return""+e},t}();function Xn(i){return Number(i||0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function R3(i,t){const e=[...i].sort((c,f)=>c.date-f.date),r=[...t].sort((c,f)=>c.date-f.date);let a=0,l=r[a]?.amount||0;for(const c of e){let f=0;for(;a<r.length&&f<c.amount;){const p=Math.min(l,c.amount-f);f+=p,l-=p,l===0&&(a+=1,l=r[a]?.amount||0)}c.abonado=f,c.pendiente=Math.max(0,c.amount-f),c.pagada=c.pendiente===0}return i}function UN(i,t){const e=[...i].sort((c,f)=>c.date-f.date),r=[...t].sort((c,f)=>c.date-f.date).map(c=>({...c}));let a=0,l=e[a]?.amount||0;for(const c of r){let f=c.amount;for(;a<e.length&&f>0;){c.saleId||(c.saleId=e[a].id,c.saleDescription=e[a].description);const p=Math.min(f,l);f-=p,l-=p,l===0&&(a+=1,l=e[a]?.amount||0)}}return r}function BN({clientId:i}){const[t,e]=me.useState(null),[r,a]=me.useState([]),[l,c]=me.useState([]);me.useEffect(()=>{(async()=>{const S=await S0(Tn(Le,"clients",i));if(!S.exists())return;e({id:S.id,...S.data()});const A=(await Yr(Si(Le,"clients",i,"sales"))).docs.map(j=>({id:j.id,...j.data()})),V=(await Yr(Si(Le,"clients",i,"payments"))).docs.map(j=>({id:j.id,...j.data()}));R3(A,V);const H=UN(A,V);a(A),c(H)})()},[i]);const f=()=>{const _=new Ce({format:"a5"}),S=_.internal.pageSize.getWidth(),T=_.internal.pageSize.getHeight(),A=10;let R=A;_.setFontSize(16),_.text("Claudia Vende",S/2,R,{align:"center"}),R+=7,_.setFontSize(12),_.text("Estado de Cuenta",S/2,R,{align:"center"}),R+=3,_.line(A,R,S-A,R),R+=6,_.setFontSize(10),_.text(`Nombre: ${t.name}`,A,R),R+=4,_.text(`Teléfono: ${t.phone}`,A,R),R+=4,_.text(`Fecha: ${new Date().toLocaleDateString()}`,A,R),R+=6,_.setFontSize(12),_.text("Resumen",A,R),R+=5,_.setFontSize(10);const V=[["Total comprado",Xn(p)],["Total abonado",Xn(y)],["Saldo pendiente",Xn(p-y)]];_.setFont(void 0,"bold"),V.forEach(X=>{_.text(String(X[0]),A,R),_.text(`$${X[1]}`,S-A,R,{align:"right"}),R+=4}),_.setFont(void 0,"normal"),R+=4,_.setFontSize(12),_.text("Detalle de ventas",A,R),R+=4,_.setFontSize(10);const H=[A,A+30,S-55,S-35,S-A];_.setFont(void 0,"bold"),_.text("Fecha",H[0],R),_.text("Producto",H[1],R),_.text("Monto",H[2],R,{align:"right"}),_.text("Abonado",H[3],R,{align:"right"}),_.text("Saldo",H[4],R,{align:"right"}),_.setFont(void 0,"normal"),R+=2,_.line(A,R,S-A,R),R+=4,r.sort((X,nt)=>X.date-nt.date).forEach(X=>{_.text(String(new Date(X.date).toLocaleDateString()),H[0],R),_.text(String(X.description),H[1],R),_.text(`$${Xn(X.amount)}`,H[2],R,{align:"right"}),_.text(`$${Xn(X.abonado)}`,H[3],R,{align:"right"}),_.text(X.pagada?"✔":`$${Xn(X.pendiente)}`,H[4],R,{align:"right"}),R+=4,R>T-A&&(_.addPage(),R=A)}),R+=6,_.setFontSize(12),_.text("Detalle de abonos",A,R),R+=4,_.setFontSize(10);const j=[A,A+30,S-A];_.setFont(void 0,"bold"),_.text("Fecha",j[0],R),_.text("Venta",j[1],R),_.text("Monto",j[2],R,{align:"right"}),_.setFont(void 0,"normal"),R+=2,_.line(A,R,S-A,R),R+=4,l.sort((X,nt)=>X.date-nt.date).forEach(X=>{_.text(String(new Date(X.date).toLocaleDateString()),j[0],R),X.saleDescription&&_.text(String(X.saleDescription),j[1],R),_.text(`$${Xn(X.amount)}`,j[2],R,{align:"right"}),R+=4,R>T-A&&(_.addPage(),R=A)}),_.setFontSize(9),_.text("¡Gracias por su preferencia!",S/2,T-A,{align:"center"}),_.save(`estado-${t.name}.pdf`)};if(!t)return G.jsx("p",{children:"Cargando..."});const p=r.reduce((_,S)=>_+S.amount,0),y=l.reduce((_,S)=>_+S.amount,0);return G.jsxs("div",{className:"space-y-6 max-w-2xl",children:[G.jsxs("h2",{className:"text-xl font-bold flex items-center justify-center gap-2",children:[G.jsx("span",{role:"img","aria-hidden":"true",children:"📋"}),"Estado de cuenta"]}),G.jsxs("div",{className:"bg-gray-50 rounded-lg p-4 grid gap-x-4 gap-y-2 text-sm sm:grid-cols-2",children:[G.jsxs("p",{children:[G.jsx("span",{className:"font-semibold",children:"Nombre:"})," ",t.name]}),G.jsxs("p",{children:[G.jsx("span",{className:"font-semibold",children:"Teléfono:"})," ",t.phone]}),t.notes&&G.jsxs("p",{className:"sm:col-span-2",children:[G.jsx("span",{className:"font-semibold",children:"Notas:"})," ",t.notes]}),G.jsxs("p",{className:"sm:col-span-2",children:[G.jsx("span",{className:"font-semibold",children:"Saldo actual:"})," $",Xn(t.balance)]})]}),G.jsx("hr",{className:"border-gray-300"}),G.jsxs("div",{className:"space-y-2",children:[G.jsx("h3",{className:"text-lg font-semibold",children:"Ventas"}),G.jsx("div",{className:"overflow-x-auto",children:G.jsxs("table",{className:"min-w-full text-sm border border-gray-200",children:[G.jsx("thead",{className:"bg-gray-100 text-gray-700",children:G.jsxs("tr",{children:[G.jsx("th",{className:"p-2 text-left",children:"Fecha"}),G.jsx("th",{className:"p-2 text-left",children:"Descripción"}),G.jsx("th",{className:"p-2 text-right",children:"Monto"}),G.jsx("th",{className:"p-2 text-center",children:"Estado"})]})}),G.jsx("tbody",{children:r.slice().sort((_,S)=>_.date-S.date).map(_=>G.jsxs("tr",{className:"border-t",children:[G.jsx("td",{className:"p-2",children:new Date(_.date).toLocaleDateString()}),G.jsx("td",{className:"p-2",children:_.description}),G.jsxs("td",{className:"p-2 text-right",children:["$",Xn(_.amount)]}),G.jsx("td",{className:"p-2 text-center",children:_.pagada?G.jsx("span",{className:"inline-flex items-center gap-1 bg-green-100 text-green-800 px-2 py-1 rounded-full text-xs font-medium",children:"✔ Pagada"}):G.jsx("span",{className:"inline-flex items-center gap-1 bg-yellow-100 text-yellow-800 px-2 py-1 rounded-full text-xs font-medium",children:"⏳ Pendiente"})})]},_.id))})]})})]}),G.jsx("hr",{className:"border-gray-300"}),G.jsxs("div",{className:"space-y-2",children:[G.jsx("h3",{className:"text-lg font-semibold",children:"Abonos"}),G.jsx("div",{className:"overflow-x-auto",children:G.jsxs("table",{className:"min-w-full text-sm border border-gray-200",children:[G.jsx("thead",{className:"bg-gray-100 text-gray-700",children:G.jsxs("tr",{children:[G.jsx("th",{className:"p-2 text-left",children:"Fecha"}),G.jsx("th",{className:"p-2 text-left",children:"Venta"}),G.jsx("th",{className:"p-2 text-right",children:"Monto"})]})}),G.jsx("tbody",{children:l.slice().sort((_,S)=>_.date-S.date).map(_=>G.jsxs("tr",{className:"border-t",children:[G.jsx("td",{className:"p-2",children:new Date(_.date).toLocaleDateString()}),G.jsx("td",{className:"p-2",children:_.saleDescription||""}),G.jsxs("td",{className:"p-2 text-right",children:["$",Xn(_.amount)]})]},_.id))})]})})]}),G.jsx("hr",{className:"border-gray-300"}),G.jsxs("div",{className:"space-y-1 text-right",children:[G.jsxs("p",{className:"font-semibold",children:["Total compras: $",Xn(p)]}),G.jsxs("p",{className:"font-semibold",children:["Total abonos: $",Xn(y)]})]}),G.jsx("div",{className:"text-center",children:G.jsxs("button",{onClick:f,className:"inline-flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white font-semibold px-4 py-2 rounded",children:[G.jsx("span",{role:"img","aria-hidden":"true",children:"🖨️"}),"Generar PDF"]})})]})}function C3({clientId:i,onDone:t}){const[e,r]=me.useState(""),[a,l]=me.useState(new Date().toISOString().split("T")[0]),c=async f=>{f.preventDefault();const p=parseFloat(e);isNaN(p)||!a||(await p1(Si(Le,"clients",i,"payments"),{amount:p,date:new Date(a).getTime()}),await Kr(Tn(Le,"clients",i),{balance:ws(-p)}),t&&t())};return G.jsxs("form",{onSubmit:c,className:"bg-white p-4 rounded shadow max-w-md mx-auto space-y-4",children:[G.jsx("h2",{className:"text-lg font-semibold text-center",children:"Registrar abono"}),G.jsx("input",{className:"w-full border rounded px-3 py-2",value:e,onChange:f=>r(f.target.value),placeholder:"Monto del abono",type:"number",step:"0.01",required:!0}),G.jsx("input",{className:"w-full border rounded px-3 py-2",type:"date",value:a,onChange:f=>l(f.target.value),required:!0}),G.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded",children:"Guardar"})]})}const FN="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='currentColor'%20aria-hidden='true'%3e%3cpath%20d='M12%2015a3%203%200%20100-6%203%203%200%20000%206z'/%3e%3cpath%20fill-rule='evenodd'%20d='M1.323%2011.447C2.811%206.976%207.028%203.75%2012.001%203.75c4.97%200%209.185%203.223%2010.675%207.69.12.362.12.752%200%201.113-1.487%204.471-5.705%207.697-10.677%207.697-4.97%200-9.186-3.223-10.675-7.69a1.762%201.762%200%20010-1.113zM17.25%2012a5.25%205.25%200%2011-10.5%200%205.25%205.25%200%200110.5%200z'%20clip-rule='evenodd'/%3e%3c/svg%3e",qN="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='currentColor'%20aria-hidden='true'%3e%3cpath%20fill-rule='evenodd'%20d='M5.625%201.5c-1.036%200-1.875.84-1.875%201.875v17.25c0%201.035.84%201.875%201.875%201.875h12.75c1.035%200%201.875-.84%201.875-1.875V12.75A3.75%203.75%200%200016.5%209h-1.875a1.875%201.875%200%2001-1.875-1.875V5.25A3.75%203.75%200%20009%201.5H5.625zM7.5%2015a.75.75%200%2001.75-.75h7.5a.75.75%200%20010%201.5h-7.5A.75.75%200%20017.5%2015zm.75%202.25a.75.75%200%20000%201.5H12a.75.75%200%20000-1.5H8.25z'%20clip-rule='evenodd'/%3e%3cpath%20d='M12.971%201.816A5.23%205.23%200%200114.25%205.25v1.875c0%20.207.168.375.375.375H16.5a5.23%205.23%200%20013.434%201.279%209.768%209.768%200%2000-6.963-6.963z'/%3e%3c/svg%3e",L3="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='currentColor'%20aria-hidden='true'%3e%3cpath%20d='M4.913%202.658c2.075-.27%204.19-.408%206.337-.408%202.147%200%204.262.139%206.337.408%201.922.25%203.291%201.861%203.405%203.727a4.403%204.403%200%2000-1.032-.211%2050.89%2050.89%200%2000-8.42%200c-2.358.196-4.04%202.19-4.04%204.434v4.286a4.47%204.47%200%20002.433%203.984L7.28%2021.53A.75.75%200%20016%2021v-4.03a48.527%2048.527%200%2001-1.087-.128C2.905%2016.58%201.5%2014.833%201.5%2012.862V6.638c0-1.97%201.405-3.718%203.413-3.979z'/%3e%3cpath%20d='M15.75%207.5c-1.376%200-2.739.057-4.086.169C10.124%207.797%209%209.103%209%2010.609v4.285c0%201.507%201.128%202.814%202.67%202.94%201.243.102%202.5.157%203.768.165l2.782%202.781a.75.75%200%20001.28-.53v-2.39l.33-.026c1.542-.125%202.67-1.433%202.67-2.94v-4.286c0-1.505-1.125-2.811-2.664-2.94A49.392%2049.392%200%200015.75%207.5z'/%3e%3c/svg%3e",vh="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='currentColor'%20aria-hidden='true'%3e%3cpath%20d='M21.731%202.269a2.625%202.625%200%2000-3.712%200l-1.157%201.157%203.712%203.712%201.157-1.157a2.625%202.625%200%20000-3.712zM19.513%208.199l-3.712-3.712-8.4%208.4a5.25%205.25%200%2000-1.32%202.214l-.8%202.685a.75.75%200%2000.933.933l2.685-.8a5.25%205.25%200%20002.214-1.32l8.4-8.4z'/%3e%3cpath%20d='M5.25%205.25a3%203%200%2000-3%203v10.5a3%203%200%20003%203h10.5a3%203%200%20003-3V13.5a.75.75%200%2000-1.5%200v5.25a1.5%201.5%200%2001-1.5%201.5H5.25a1.5%201.5%200%2001-1.5-1.5V8.25a1.5%201.5%200%20011.5-1.5h5.25a.75.75%200%20000-1.5H5.25z'/%3e%3c/svg%3e",Of="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='currentColor'%20aria-hidden='true'%3e%3cpath%20fill-rule='evenodd'%20d='M16.5%204.478v.227a48.816%2048.816%200%20013.878.512.75.75%200%2011-.256%201.478l-.209-.035-1.005%2013.07a3%203%200%2001-2.991%202.77H8.084a3%203%200%2001-2.991-2.77L4.087%206.66l-.209.035a.75.75%200%2001-.256-1.478A48.567%2048.567%200%20017.5%204.705v-.227c0-1.564%201.213-2.9%202.816-2.951a52.662%2052.662%200%20013.369%200c1.603.051%202.815%201.387%202.815%202.951zm-6.136-1.452a51.196%2051.196%200%20013.273%200C14.39%203.05%2015%203.684%2015%204.478v.113a49.488%2049.488%200%2000-6%200v-.113c0-.794.609-1.428%201.364-1.452zm-.355%205.945a.75.75%200%2010-1.5.058l.347%209a.75.75%200%20101.499-.058l-.346-9zm5.48.058a.75.75%200%2010-1.498-.058l-.347%209a.75.75%200%20001.5.058l.345-9z'%20clip-rule='evenodd'/%3e%3c/svg%3e",Um="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='currentColor'%20aria-hidden='true'%3e%3cpath%20fill-rule='evenodd'%20d='M12%203.75a.75.75%200%2001.75.75v6.75h6.75a.75.75%200%20010%201.5h-6.75v6.75a.75.75%200%2001-1.5%200v-6.75H4.5a.75.75%200%20010-1.5h6.75V4.5a.75.75%200%2001.75-.75z'%20clip-rule='evenodd'/%3e%3c/svg%3e",Tp="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='currentColor'%20aria-hidden='true'%3e%3cpath%20d='M10.464%208.746c.227-.18.497-.311.786-.394v2.795a2.252%202.252%200%2001-.786-.393c-.394-.313-.546-.681-.546-1.004%200-.323.152-.691.546-1.004zM12.75%2015.662v-2.824c.347.085.664.228.921.421.427.32.579.686.579.991%200%20.305-.152.671-.579.991a2.534%202.534%200%2001-.921.42z'/%3e%3cpath%20fill-rule='evenodd'%20d='M12%202.25c-5.385%200-9.75%204.365-9.75%209.75s4.365%209.75%209.75%209.75%209.75-4.365%209.75-9.75S17.385%202.25%2012%202.25zM12.75%206a.75.75%200%2000-1.5%200v.816a3.836%203.836%200%2000-1.72.756c-.712.566-1.112%201.35-1.112%202.178%200%20.829.4%201.612%201.113%202.178.502.4%201.102.647%201.719.756v2.978a2.536%202.536%200%2001-.921-.421l-.879-.66a.75.75%200%2000-.9%201.2l.879.66c.533.4%201.169.645%201.821.75V18a.75.75%200%20001.5%200v-.81a4.124%204.124%200%20001.821-.749c.745-.559%201.179-1.344%201.179-2.191%200-.847-.434-1.632-1.179-2.191a4.122%204.122%200%2000-1.821-.75V8.354c.29.082.559.213.786.393l.415.33a.75.75%200%2000.933-1.175l-.415-.33a3.836%203.836%200%2000-1.719-.755V6z'%20clip-rule='evenodd'/%3e%3c/svg%3e";function Uv({go:i}){const[t,e]=me.useState([]),[r,a]=me.useState(""),[l,c]=me.useState(!1),[f,p]=me.useState(null),[y,_]=me.useState(null),[S,T]=me.useState(null),{role:A}=nd(),R=async()=>{const j=await Yr(Si(Le,"clients"));e(j.docs.map(X=>({id:X.id,...X.data()})))};me.useEffect(()=>{R()},[]);const V=t.filter(j=>j.name.toLowerCase().includes(r.toLowerCase())),H=async j=>{window.confirm("¿Eliminar este cliente?")&&(await ch(Tn(Le,"clients",j.id)),R())};return G.jsxs("div",{className:"space-y-4",children:[G.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[G.jsxs("button",{onClick:()=>c(!0),className:"flex items-center gap-2 bg-blue-500 text-white px-3 py-2 rounded w-full sm:w-auto",children:[G.jsx("img",{src:Um,alt:"",className:"w-5 h-5"}),"Nuevo cliente"]}),G.jsxs("div",{className:"relative w-full sm:w-auto",children:[G.jsx("input",{className:"border rounded px-3 py-2 pr-8 w-full",placeholder:"Buscar cliente",value:r,onChange:j=>a(j.target.value)}),r&&G.jsx("button",{type:"button",onClick:()=>a(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-700",children:"×"})]})]}),G.jsx("ul",{className:"grid gap-3",children:V.map(j=>{const X=(j.phone||"").replace(/\D/g,"");return G.jsxs("li",{className:"card border-l-4 border-blue-500",children:[G.jsxs("div",{className:"flex-1",children:[G.jsx("p",{className:"font-semibold",children:j.name}),G.jsxs("p",{className:"text-sm text-gray-800",children:["Deuda: ",`$${Xn(j.balance)}`]})]}),G.jsxs("span",{className:"actions",children:[G.jsx("button",{onClick:()=>i("client",j.id),title:"Ver",children:G.jsx("img",{src:FN,alt:"ver",className:"icon"})}),G.jsx("button",{onClick:()=>_(j.id),title:"Estado",children:G.jsx("img",{src:qN,alt:"estado",className:"icon"})}),G.jsx("button",{onClick:()=>T(j.id),title:"Abono",children:G.jsx("img",{src:Tp,alt:"abono",className:"icon"})}),X&&G.jsx("a",{href:`https://wa.me/${X}`,target:"_blank",rel:"noopener noreferrer",title:"Mensaje",children:G.jsx("img",{src:L3,alt:"mensaje",className:"icon"})}),A==="Administrador"&&G.jsxs(G.Fragment,{children:[G.jsx("button",{onClick:()=>p(j),title:"Editar",children:G.jsx("img",{src:vh,alt:"editar",className:"icon"})}),G.jsx("button",{onClick:()=>H(j),title:"Eliminar",children:G.jsx("img",{src:Of,alt:"eliminar",className:"icon"})})]})]})]},j.id)})}),l&&G.jsx(Oo,{onClose:()=>c(!1),children:G.jsx(N0,{onDone:()=>{c(!1),R()}})}),f&&G.jsx(Oo,{onClose:()=>p(null),children:G.jsx(N0,{client:f,onDone:()=>{p(null),R()}})}),y&&G.jsx(Oo,{onClose:()=>_(null),children:G.jsx(BN,{clientId:y})}),S&&G.jsx(Oo,{onClose:()=>T(null),children:G.jsx(C3,{clientId:S,onDone:()=>{T(null),R()}})})]})}function zN({id:i,go:t}){const[e,r]=me.useState(null),[a,l]=me.useState([]),[c,f]=me.useState([]),[p,y]=me.useState(""),[_,S]=me.useState(!1),[T,A]=me.useState(null),[R,V]=me.useState(""),[H,j]=me.useState(""),[X,nt]=me.useState(null),[At,bt]=me.useState(""),[kt,W]=me.useState(""),{role:L}=nd();me.useEffect(()=>{const B=z2(Tn(Le,"clients",i),U=>{r({id:U.id,...U.data()})}),pt=z2(Si(Le,"clients",i,"payments"),U=>{l(U.docs.map(J=>({id:J.id,...J.data()})).sort((J,rt)=>J.date-rt.date))}),P=z2(Si(Le,"clients",i,"sales"),U=>{f(U.docs.map(J=>({id:J.id,...J.data()})).sort((J,rt)=>J.date-rt.date))});return()=>{B(),pt(),P()}},[i]);const z=async B=>{if(B.preventDefault(),!p)return;const pt=parseFloat(p);await p1(Si(Le,"clients",i,"payments"),{amount:pt,date:Date.now()}),await Kr(Tn(Le,"clients",i),{balance:ws(-pt)}),y("")},Z=B=>{A(B.id),V(B.amount),j(new Date(B.date).toISOString().split("T")[0])},I=()=>{A(null),V(""),j("")},C=async B=>{const pt=parseFloat(R);if(isNaN(pt)||!H)return;await Kr(Tn(Le,"clients",i,"payments",B.id),{amount:pt,date:new Date(H).getTime()});const P=pt-B.amount;P!==0&&await Kr(Tn(Le,"clients",i),{balance:ws(-P)}),I()},O=async B=>{window.confirm("¿Eliminar este abono?")&&(await ch(Tn(Le,"clients",i,"payments",B.id)),await Kr(Tn(Le,"clients",i),{balance:ws(B.amount)}))},at=B=>{nt(B.id),bt(B.amount),W(new Date(B.date).toISOString().split("T")[0])},Tt=()=>{nt(null),bt(""),W("")},et=async B=>{const pt=parseFloat(At);if(isNaN(pt)||!kt)return;await Kr(Tn(Le,"clients",i,"sales",B.id),{amount:pt,date:new Date(kt).getTime()});const P=pt-B.amount;P!==0&&await Kr(Tn(Le,"clients",i),{balance:ws(P),total:ws(P)}),Tt()},ht=async B=>{window.confirm("¿Eliminar esta venta?")&&(await ch(Tn(Le,"clients",i,"sales",B.id)),await Kr(Tn(Le,"clients",i),{balance:ws(-B.amount),total:ws(-B.amount)}))},ut=async()=>{window.confirm("¿Eliminar este cliente?")&&(await ch(Tn(Le,"clients",i)),t("clients"))},Nt=R3(c.map(B=>({...B})),a);return e?G.jsxs("div",{className:"space-y-4",children:[G.jsx("button",{onClick:()=>t("list"),className:"bg-blue-500 text-white px-3 py-2 rounded",children:"Regresar"}),G.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[e.name,L==="Administrador"&&G.jsxs(G.Fragment,{children:[G.jsx("button",{onClick:()=>S(!0),children:G.jsx("img",{src:vh,alt:"editar",className:"icon"})}),G.jsx("button",{onClick:ut,children:G.jsx("img",{src:Of,alt:"eliminar",className:"icon"})})]})]}),G.jsxs("p",{className:"text-gray-800",children:["Teléfono: ",e.phone]}),e.notes&&G.jsxs("p",{className:"text-gray-800",children:["Observaciones: ",e.notes]}),G.jsxs("p",{className:"text-gray-800",children:["Deuda actual: $",Xn(e.balance)]}),G.jsxs("form",{onSubmit:z,className:"flex gap-2",children:[G.jsx("input",{className:"border rounded px-3 py-2 flex-1",value:p,onChange:B=>y(B.target.value),placeholder:"Monto del abono",type:"number",step:"0.01"}),G.jsx("button",{type:"submit",className:"bg-blue-500 text-white px-3 py-2 rounded",children:"Registrar abono"})]}),G.jsxs("div",{className:"section",children:[G.jsx("h3",{className:"text-lg font-semibold flex items-center gap-2",children:"🛍️ Ventas"}),G.jsx("ul",{className:"grid gap-2",children:Nt.map(B=>G.jsx("li",{className:"card",children:L==="Administrador"&&X===B.id?G.jsxs(G.Fragment,{children:[G.jsx("input",{className:"border rounded px-2 py-1 mr-2",type:"number",step:"0.01",value:At,onChange:pt=>bt(pt.target.value)}),G.jsx("input",{className:"border rounded px-2 py-1 mr-2",type:"date",value:kt,onChange:pt=>W(pt.target.value)}),G.jsx("button",{onClick:()=>et(B),className:"bg-blue-500 text-white px-2 py-1 rounded mr-1",children:"Guardar"}),G.jsx("button",{onClick:Tt,className:"px-2 py-1 rounded border",children:"Cancelar"})]}):G.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 w-full",children:[G.jsxs("div",{className:"flex-1 space-y-1",children:[G.jsxs("p",{className:"text-sm flex items-center gap-1",children:[G.jsx("span",{children:"📅"}),new Date(B.date).toLocaleDateString()]}),G.jsxs("p",{className:"text-sm flex items-center gap-1",children:[G.jsx("span",{children:"🛍️"}),B.description]}),G.jsxs("p",{className:"text-sm flex items-center gap-1 font-medium",children:[G.jsx("span",{children:"💲"}),"$",Xn(B.amount)]})]}),G.jsxs("div",{className:"flex items-center gap-2",children:[G.jsx("span",{className:`inline-flex items-center gap-1 text-xs font-medium px-2 py-1 rounded-full ${B.pagada?"bg-green-100 text-green-800":"bg-yellow-100 text-yellow-800"}`,children:B.pagada?"✅ Pagada":"⚠️ Pendiente"}),L==="Administrador"&&G.jsxs(G.Fragment,{children:[G.jsx("button",{onClick:()=>at(B),title:"Editar",children:G.jsx("img",{src:vh,alt:"editar",className:"icon"})}),G.jsx("button",{onClick:()=>ht(B),title:"Eliminar",children:G.jsx("img",{src:Of,alt:"eliminar",className:"icon"})})]})]})]})},B.id))})]}),G.jsxs("div",{className:"section",children:[G.jsx("h3",{className:"text-lg font-semibold flex items-center gap-2",children:"💸 Abonos"}),G.jsx("ul",{className:"grid gap-2",children:a.map(B=>G.jsx("li",{className:"card",children:T===B.id?G.jsxs(G.Fragment,{children:[G.jsx("input",{className:"border rounded px-2 py-1 mr-2",type:"number",step:"0.01",value:R,onChange:pt=>V(pt.target.value)}),G.jsx("input",{className:"border rounded px-2 py-1 mr-2",type:"date",value:H,onChange:pt=>j(pt.target.value)}),G.jsx("button",{onClick:()=>C(B),className:"bg-blue-500 text-white px-2 py-1 rounded mr-1",children:"Guardar"}),G.jsx("button",{onClick:I,className:"px-2 py-1 rounded border",children:"Cancelar"})]}):G.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2 w-full",children:[G.jsxs("div",{className:"flex-1 space-y-1",children:[G.jsxs("p",{className:"text-sm flex items-center gap-1",children:[G.jsx("span",{children:"📅"}),new Date(B.date).toLocaleDateString()]}),G.jsxs("p",{className:"text-sm flex items-center gap-1 font-medium",children:[G.jsx("span",{children:"💲"}),"$",Xn(B.amount)]})]}),G.jsxs("div",{className:"flex items-center gap-2",children:[G.jsx("button",{onClick:()=>Z(B),title:"Editar",children:G.jsx("img",{src:vh,alt:"editar",className:"icon"})}),G.jsx("button",{onClick:()=>O(B),title:"Eliminar",children:G.jsx("img",{src:Of,alt:"eliminar",className:"icon"})})]})]})},B.id))})]}),L==="Administrador"&&_&&G.jsx(Oo,{onClose:()=>S(!1),children:G.jsx(N0,{client:e,onDone:()=>S(!1)})})]}):G.jsx("p",{children:"Cargando..."})}const HN="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='currentColor'%20aria-hidden='true'%3e%3cpath%20d='M2.25%202.25a.75.75%200%20000%201.5h1.386c.17%200%20.318.114.362.278l2.558%209.592a3.752%203.752%200%2000-2.806%203.63c0%20.414.336.75.75.75h15.75a.75.75%200%20000-1.5H5.378A2.25%202.25%200%20017.5%2015h11.218a.75.75%200%2000.674-.421%2060.358%2060.358%200%20002.96-7.228.75.75%200%2000-.525-.965A60.864%2060.864%200%20005.68%204.509l-.232-.867A1.875%201.875%200%20003.636%202.25H2.25zM3.75%2020.25a1.5%201.5%200%20113%200%201.5%201.5%200%2001-3%200zM16.5%2020.25a1.5%201.5%200%20113%200%201.5%201.5%200%2001-3%200z'/%3e%3c/svg%3e",GN="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%2024%2024'%20fill='currentColor'%20aria-hidden='true'%3e%3cpath%20fill-rule='evenodd'%20d='M8.25%206.75a3.75%203.75%200%20117.5%200%203.75%203.75%200%2001-7.5%200zM15.75%209.75a3%203%200%20116%200%203%203%200%2001-6%200zM2.25%209.75a3%203%200%20116%200%203%203%200%2001-6%200zM6.31%2015.117A6.745%206.745%200%200112%2012a6.745%206.745%200%20016.709%207.498.75.75%200%2001-.372.568A12.696%2012.696%200%200112%2021.75c-2.305%200-4.47-.612-6.337-1.684a.75.75%200%2001-.372-.568%206.787%206.787%200%20011.019-4.38z'%20clip-rule='evenodd'/%3e%3cpath%20d='M5.082%2014.254a8.287%208.287%200%2000-1.308%205.135%209.687%209.687%200%2001-1.764-.44l-.115-.04a.563.563%200%2001-.373-.487l-.01-.121a3.75%203.75%200%20013.57-4.047zM20.226%2019.389a8.287%208.287%200%2000-1.308-5.135%203.75%203.75%200%20013.57%204.047l-.01.121a.563.563%200%2001-.373.486l-.115.04c-.567.2-1.156.349-1.764.441z'/%3e%3c/svg%3e";function YN(){const[i,t]=me.useState({outstanding:0,monthlyPayments:0,totalSales:0,recoveryRate:0,avgPayDays:0,topDebtor:null,dueBalance:0,overdueBalance:0,monthlySales:[]}),[e,r]=me.useState([]),[a,l]=me.useState(null),c=me.useRef(null),f=async()=>{const _=await Yr(Si(Le,"clients")),S=Date.now(),T=720*60*60*1e3,A=new Date(new Date().getFullYear(),new Date().getMonth(),1).getTime(),R={};let V=0,H=0,j=0,X=0,nt=0,At={balance:0},bt=0,kt=0;const W=[];for(const O of _.docs){const at=O.data(),Tt=O.id,et=at.balance||0,ht=at.name;V+=et,et>At.balance&&(At={id:Tt,name:ht,balance:et});const ut=await Yr(Si(Le,"clients",Tt,"sales")),Nt=await Yr(Si(Le,"clients",Tt,"payments")),B=ut.docs.map(U=>({id:U.id,...U.data()})).sort((U,J)=>U.date-J.date),pt=Nt.docs.map(U=>({id:U.id,...U.data()})).sort((U,J)=>U.date-J.date);if(B.forEach(U=>{H+=U.amount;const J=new Date(U.date),rt=`${J.getFullYear()}-${String(J.getMonth()+1).padStart(2,"0")}`;R[rt]=(R[rt]||0)+U.amount}),pt.forEach(U=>{U.date>=A&&(j+=U.amount)}),et>0){let U=0;pt.forEach(J=>{J.date>U&&(U=J.date)}),!U&&B.length&&(U=B[B.length-1].date),S-U>=T?(kt+=et,W.push({id:Tt,name:ht,phone:at.phone,balance:et,lastPayment:U})):bt+=et}const P=B.map(U=>({date:U.date,remaining:U.amount}));for(const U of pt){let J=U.amount;for(;J>0&&P.length;){const rt=P[0],lt=Math.min(rt.remaining,J);if(X+=(U.date-rt.date)/(1e3*60*60*24),nt++,rt.remaining-=lt,J-=lt,rt.remaining<=0)P.shift();else break}}}const L=6;let Z=Object.keys(R).sort().slice(-L).map(O=>({month:O,total:R[O]}));if(Z.length===0){const O=new Date;Z=[];for(let at=L-1;at>=0;at--){const Tt=new Date(O.getFullYear(),O.getMonth()-at,1),et=`${Tt.getFullYear()}-${String(Tt.getMonth()+1).padStart(2,"0")}`;Z.push({month:et,total:R[et]||0})}}const I=H?j/H*100:0,C=nt?X/nt:0;t({outstanding:V,monthlyPayments:j,totalSales:H,recoveryRate:I,avgPayDays:C,topDebtor:At,dueBalance:bt,overdueBalance:kt,monthlySales:Z}),r(W)};me.useEffect(()=>{f()},[]);const p=async()=>{const _={},S=await Yr(Si(Le,"clients")),T=[];for(const X of S.docs){const nt=await Yr(Si(Le,"clients",X.id,"sales")),At=await Yr(Si(Le,"clients",X.id,"payments"));T.push({id:X.id,...X.data(),sales:nt.docs.map(bt=>({id:bt.id,...bt.data()})),payments:At.docs.map(bt=>({id:bt.id,...bt.data()}))})}_.clients=T;const A=await Yr(Si(Le,"usuarios"));_.usuarios=A.docs.map(X=>({id:X.id,...X.data()}));const R=await Yr(Si(Le,"users"));_.users=R.docs.map(X=>({id:X.id,...X.data()}));const V=new Blob([JSON.stringify(_,null,2)],{type:"application/json"}),H=URL.createObjectURL(V),j=document.createElement("a");j.href=H,j.download="database.json",j.click(),URL.revokeObjectURL(H)},y=async _=>{const S=_.target.files[0];if(!S)return;const T=await S.text(),A=JSON.parse(T);if(A.clients)for(const R of A.clients){if(await _u(Tn(Le,"clients",R.id),{name:R.name,phone:R.phone,notes:R.notes,balance:R.balance,total:R.total}),R.sales)for(const V of R.sales)await _u(Tn(Le,"clients",R.id,"sales",V.id),{amount:V.amount,date:V.date});if(R.payments)for(const V of R.payments)await _u(Tn(Le,"clients",R.id,"payments",V.id),{amount:V.amount,date:V.date})}if(A.usuarios)for(const R of A.usuarios)await _u(Tn(Le,"usuarios",R.id),R);if(A.users)for(const R of A.users)await _u(Tn(Le,"users",R.id),R);alert("Importación completada")};return G.jsxs("div",{className:"space-y-6",children:[G.jsx("h2",{className:"text-xl font-semibold",children:"Panel de Finanzas"}),G.jsxs("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:[G.jsxs("div",{className:"bg-white p-4 rounded shadow flex items-center gap-3",children:[G.jsx("img",{src:Tp,alt:"",className:"w-6 h-6 text-blue-600"}),G.jsxs("div",{children:[G.jsx("p",{className:"text-sm text-gray-600",children:"Saldo por cobrar"}),G.jsx("p",{className:"text-lg font-bold",children:`$${Xn(i.outstanding)}`})]})]}),G.jsxs("div",{className:"bg-white p-4 rounded shadow flex items-center gap-3",children:[G.jsx("img",{src:Tp,alt:"",className:"w-6 h-6 text-green-600"}),G.jsxs("div",{children:[G.jsx("p",{className:"text-sm text-gray-600",children:"Abonos del mes"}),G.jsx("p",{className:"text-lg font-bold",children:`$${Xn(i.monthlyPayments)}`})]})]}),G.jsxs("div",{className:"bg-white p-4 rounded shadow flex items-center gap-3",children:[G.jsx("img",{src:HN,alt:"",className:"w-6 h-6 text-blue-600"}),G.jsxs("div",{children:[G.jsx("p",{className:"text-sm text-gray-600",children:"Total ventas a crédito"}),G.jsx("p",{className:"text-lg font-bold",children:`$${Xn(i.totalSales)}`})]})]}),G.jsxs("div",{className:"bg-white p-4 rounded shadow flex items-center gap-3",children:[G.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:G.jsx("path",{d:"M2.25 13.5A8.25 8.25 0 0110.5 5.25V3a.75.75 0 011.5 0v2.25A8.25 8.25 0 0120.25 13.5h2.25a.75.75 0 010 1.5H20.25A8.25 8.25 0 0111.25 23.25v2.25a.75.75 0 01-1.5 0v-2.25A8.25 8.25 0 012.25 15H0a.75.75 0 010-1.5h2.25z"})}),G.jsxs("div",{children:[G.jsx("p",{className:"text-sm text-gray-600",children:"Recuperación"}),G.jsxs("p",{className:"text-lg font-bold",children:[i.recoveryRate.toFixed(1),"%"]})]})]}),G.jsxs("div",{className:"bg-white p-4 rounded shadow flex items-center gap-3",children:[G.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6 text-blue-600",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:G.jsx("path",{fillRule:"evenodd",d:"M12 1.5a10.5 10.5 0 100 21 10.5 10.5 0 000-21zM12 3a9 9 0 110 18A9 9 0 0112 3zm-.75 4.5a.75.75 0 011.5 0v4.336l3.404 1.967a.75.75 0 01-.758 1.288l-3.75-2.167A.75.75 0 0111.25 12V7.5z",clipRule:"evenodd"})}),G.jsxs("div",{children:[G.jsx("p",{className:"text-sm text-gray-600",children:"Promedio de pago (días)"}),G.jsx("p",{className:"text-lg font-bold",children:i.avgPayDays.toFixed(1)})]})]}),i.topDebtor&&G.jsxs("div",{className:"bg-white p-4 rounded shadow flex items-center gap-3",children:[G.jsx("img",{src:GN,alt:"",className:"w-6 h-6 text-red-600"}),G.jsxs("div",{children:[G.jsx("p",{className:"text-sm text-gray-600",children:"Mayor saldo"}),G.jsx("p",{className:"text-lg font-bold",children:`${i.topDebtor.name} - $${Xn(i.topDebtor.balance)}`})]})]})]}),G.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[G.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[G.jsx("h3",{className:"font-medium mb-2",children:"Distribución de saldos"}),G.jsxs("div",{className:"flex items-center gap-2",children:[G.jsxs("div",{className:"flex-1 h-4 bg-gray-200 rounded overflow-hidden flex",children:[G.jsx("div",{className:"bg-green-500",style:{width:`${i.dueBalance/(i.dueBalance+i.overdueBalance||1)*100}%`}}),G.jsx("div",{className:"bg-red-500",style:{width:`${i.overdueBalance/(i.dueBalance+i.overdueBalance||1)*100}%`}})]}),G.jsx("span",{className:"text-sm",children:`$${Xn(i.dueBalance)} / $${Xn(i.overdueBalance)}`})]})]}),G.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[G.jsx("h3",{className:"font-medium mb-2",children:"Ventas a crédito por mes"}),G.jsx("div",{className:"flex items-end gap-1 h-32",children:(()=>{const _=Math.max(...i.monthlySales.map(S=>S.total),1);return i.monthlySales.map(S=>G.jsxs("div",{className:"flex flex-col items-center flex-1",children:[G.jsx("div",{className:"bg-blue-500 w-full",style:{height:`${S.total/_*100}%`}}),G.jsx("span",{className:"text-xs mt-1",children:S.month.slice(5)})]},S.month))})()})]})]}),e.length>0&&G.jsxs("div",{className:"space-y-2",children:[G.jsx("h3",{className:"text-lg font-semibold",children:"Clientes Morosos"}),G.jsx("ul",{className:"grid gap-3",children:e.map(_=>{const S=(_.phone||"").replace(/\D/g,"");return G.jsxs("li",{className:"card border-l-4 border-red-500",children:[G.jsxs("div",{className:"flex-1",children:[G.jsx("p",{className:"font-semibold",children:`${_.name} - $${Xn(_.balance)}`}),G.jsxs("p",{className:"text-sm text-gray-700",children:["Último abono: ",new Date(_.lastPayment).toLocaleDateString()]})]}),G.jsxs("span",{className:"actions",children:[G.jsx("button",{onClick:()=>l(_.id),title:"Abono",children:G.jsx("img",{src:Tp,alt:"abono",className:"icon"})}),S&&G.jsx("a",{href:`https://wa.me/${S}`,target:"_blank",rel:"noopener noreferrer",title:"Mensaje",children:G.jsx("img",{src:L3,alt:"mensaje",className:"icon"})})]})]},_.id)})})]}),a&&G.jsx(Oo,{onClose:()=>l(null),children:G.jsx(C3,{clientId:a,onDone:()=>{l(null),f()}})}),G.jsxs("div",{className:"flex gap-2",children:[G.jsx("button",{onClick:p,className:"bg-blue-500 text-white px-3 py-1 rounded",children:"Exportar DB"}),G.jsx("button",{onClick:()=>c.current.click(),className:"bg-blue-500 text-white px-3 py-1 rounded",children:"Importar DB"})]}),G.jsx("input",{type:"file",accept:"application/json",ref:c,style:{display:"none"},onChange:y})]})}function Bv({go:i,onDone:t,sale:e}){const[r,a]=me.useState([]),[l,c]=me.useState(e?.clientId||""),[f,p]=me.useState(e?.amount||""),[y,_]=me.useState(e?.description||""),[S,T]=me.useState(()=>e?.date?new Date(e.date).toISOString().split("T")[0]:new Date().toISOString().split("T")[0]);me.useEffect(()=>{(async()=>{const V=await Yr(Si(Le,"clients"));a(V.docs.map(H=>({id:H.id,...H.data()})))})()},[]),me.useEffect(()=>{e&&(c(e.clientId),p(e.amount),_(e.description),T(new Date(e.date).toISOString().split("T")[0]))},[e]);const A=async R=>{if(R.preventDefault(),!l||!f||!y||!S)return;const V=parseFloat(f),H=Tn(Le,"clients",l);if(e){const j=V-e.amount;await Kr(Tn(H,"sales",e.id),{amount:V,description:y,date:new Date(S).getTime()}),j!==0&&await Kr(H,{balance:ws(j),total:ws(j)})}else{const j=new Date(S).getTime();await p1(Si(H,"sales"),{amount:V,description:y,date:j}),await Kr(H,{balance:ws(V),total:ws(V)});const X=r.find(nt=>nt.id===l);if(X){const nt=new Ce({unit:"mm",format:[58,100]});nt.setFont("helvetica","bold"),nt.setFontSize(16),nt.text("Claudia Vende",29,8,{align:"center"}),nt.setLineWidth(.1),nt.line(5,11,53,11),nt.setFont("helvetica","normal"),nt.setFontSize(10),nt.text(`Cliente: ${X.name}`,5,17),nt.text(`Fecha: ${new Date(j).toLocaleString()}`,5,23),nt.line(5,26,53,26),nt.setFont("helvetica","bold"),nt.text("Descripción",5,32),nt.text("Monto",53,32,{align:"right"}),nt.setFont("helvetica","normal"),nt.text(String(y),5,38),nt.text(`$${Xn(V)}`,53,38,{align:"right"}),nt.line(5,44,53,44),nt.setFont("helvetica","bold"),nt.text("TOTAL:",40,50,{align:"right"}),nt.setFontSize(14),nt.text(`$${Xn(V)}`,53,50,{align:"right"}),nt.setFont("helvetica","normal"),nt.setFontSize(9),nt.text("¡Gracias por tu compra!",29,96,{align:"center"}),nt.save("ticket.pdf")}}t?t(l):i("client",l)};return G.jsxs("form",{onSubmit:A,className:"bg-white p-4 rounded shadow max-w-md mx-auto space-y-4",children:[G.jsx("h2",{className:"text-lg font-semibold text-center",children:e?"Editar Venta":"Nueva Venta"}),e?G.jsxs("p",{className:"font-medium",children:["Cliente: ",e.clientName]}):G.jsxs("select",{className:"w-full border rounded px-3 py-2",value:l,onChange:R=>c(R.target.value),required:!0,children:[G.jsx("option",{value:"",disabled:!0,children:"Selecciona un cliente"}),r.map(R=>G.jsx("option",{value:R.id,children:R.name},R.id))]}),G.jsx("input",{className:"w-full border rounded px-3 py-2",value:y,onChange:R=>_(R.target.value),placeholder:"Descripción",required:!0}),G.jsx("input",{className:"w-full border rounded px-3 py-2",value:f,onChange:R=>p(R.target.value),placeholder:"Monto",type:"number",step:"0.01",required:!0}),G.jsx("input",{className:"w-full border rounded px-3 py-2",type:"date",value:S,onChange:R=>T(R.target.value),required:!0}),G.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded",children:e?"Guardar cambios":"Registrar venta"})]})}function KN(){const[i,t]=me.useState([]),[e,r]=me.useState(""),[a,l]=me.useState(!1),[c,f]=me.useState(null),{role:p}=nd(),y=async()=>{const T=await Yr(Si(Le,"clients")),A=[];for(const R of T.docs)(await Yr(Si(Le,"clients",R.id,"sales"))).forEach(H=>{A.push({id:H.id,clientId:R.id,clientName:R.data().name,...H.data()})});t(A)};me.useEffect(()=>{y()},[]);const _=async T=>{window.confirm("¿Eliminar esta venta?")&&(await ch(Tn(Le,"clients",T.clientId,"sales",T.id)),await Kr(Tn(Le,"clients",T.clientId),{balance:ws(-T.amount),total:ws(-T.amount)}),y())},S=i.filter(T=>T.clientName.toLowerCase().includes(e.toLowerCase()));return G.jsxs("div",{className:"space-y-4",children:[G.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between gap-2",children:[G.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 bg-blue-500 text-white px-3 py-2 rounded w-full sm:w-auto",children:[G.jsx("img",{src:Um,alt:"",className:"w-5 h-5"}),"Nueva venta"]}),G.jsxs("div",{className:"relative w-full sm:w-auto",children:[G.jsx("input",{className:"border rounded px-3 py-2 pr-8 w-full",placeholder:"Buscar por cliente",value:e,onChange:T=>r(T.target.value)}),e&&G.jsx("button",{type:"button",onClick:()=>r(""),className:"absolute right-2 top-1/2 -translate-y-1/2 text-gray-700",children:"×"})]})]}),G.jsx("ul",{className:"grid gap-3",children:S.map(T=>G.jsxs("li",{className:"card border-l-4 border-blue-500",children:[G.jsxs("div",{className:"flex-1",children:[G.jsx("p",{className:"font-semibold",children:T.clientName}),G.jsxs("p",{className:"text-sm text-gray-800",children:[new Date(T.date).toLocaleDateString()," - ",T.description," - $",Xn(T.amount)]})]}),G.jsx("span",{className:"actions",children:p==="Administrador"&&G.jsxs(G.Fragment,{children:[G.jsx("button",{onClick:()=>f(T),title:"Editar",children:G.jsx("img",{src:vh,alt:"editar",className:"icon"})}),G.jsx("button",{onClick:()=>_(T),title:"Eliminar",children:G.jsx("img",{src:Of,alt:"eliminar",className:"icon"})})]})})]},`${T.clientId}-${T.id}`))}),a&&G.jsx(Oo,{onClose:()=>l(!1),children:G.jsx(Bv,{onDone:()=>{l(!1),y()}})}),p==="Administrador"&&c&&G.jsx(Oo,{onClose:()=>f(null),children:G.jsx(Bv,{sale:c,onDone:()=>{f(null),y()}})})]})}function QN({onDone:i}){const[t,e]=me.useState(""),[r,a]=me.useState(""),[l,c]=me.useState("Vendedor"),f=async p=>{p.preventDefault(),r&&(await _u(Tn(Le,"usuarios",r),{createdAt:Date.now(),name:t,role:l}),i&&i())};return G.jsxs("form",{onSubmit:f,className:"bg-white p-4 rounded shadow max-w-md mx-auto space-y-4",children:[G.jsx("h2",{className:"text-lg font-semibold text-center",children:"Nuevo Usuario"}),G.jsx("input",{className:"w-full border rounded px-3 py-2",value:t,onChange:p=>e(p.target.value),placeholder:"Nombre",required:!0}),G.jsx("input",{className:"w-full border rounded px-3 py-2",type:"email",value:r,onChange:p=>a(p.target.value),placeholder:"Correo",required:!0}),G.jsxs("select",{className:"w-full border rounded px-3 py-2",value:l,onChange:p=>c(p.target.value),children:[G.jsx("option",{value:"Vendedor",children:"Vendedor"}),G.jsx("option",{value:"Administrador",children:"Administrador"})]}),G.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded",children:"Guardar"})]})}function XN({user:i,onDone:t}){const[e,r]=me.useState("");me.useEffect(()=>{r(i.displayName||"")},[i]);const a=async l=>{l.preventDefault(),e&&(await Kr(Tn(Le,"users",i.id),{displayName:e}),t&&t())};return G.jsxs("form",{onSubmit:a,className:"bg-white p-4 rounded shadow max-w-md mx-auto space-y-4",children:[G.jsx("h2",{className:"text-lg font-semibold text-center",children:"Editar nombre"}),G.jsx("input",{className:"w-full border rounded px-3 py-2",value:e,onChange:l=>r(l.target.value),placeholder:"Nombre",required:!0}),G.jsx("button",{type:"submit",className:"w-full bg-blue-500 text-white py-2 rounded",children:"Guardar"})]})}function WN(){const[i,t]=me.useState([]),[e,r]=me.useState([]),[a,l]=me.useState(!1),[c,f]=me.useState(null),p=async()=>{const T=await Yr(Si(Le,"usuarios"));t(T.docs.map(R=>({id:R.id,...R.data()})));const A=await Yr(Si(Le,"users"));r(A.docs.map(R=>({id:R.id,...R.data()})))};me.useEffect(()=>{p()},[]);const y=async T=>{await ch(Tn(Le,"usuarios",T)),p()},_=async(T,A,R)=>{T&&await Kr(Tn(Le,"users",T),{role:R}),await Kr(Tn(Le,"usuarios",A),{role:R}),p()},S=i.map(T=>{const A=e.find(R=>R.email===T.id);return{email:T.id,name:A?.displayName||T.name,photoURL:A?.photoURL,role:A?.role||T.role||"Vendedor",userId:A?.id}});return G.jsxs("div",{className:"space-y-6",children:[G.jsx("div",{className:"flex justify-start",children:G.jsxs("button",{onClick:()=>l(!0),className:"flex items-center gap-2 bg-blue-500 text-white px-3 py-2 rounded w-full sm:w-auto",children:[G.jsx("img",{src:Um,alt:"",className:"w-5 h-5"}),"Nuevo usuario"]})}),G.jsxs("div",{className:"space-y-2",children:[G.jsx("h3",{className:"text-lg font-semibold",children:"Usuarios Registrados"}),G.jsx("ul",{className:"grid gap-2",children:S.map(T=>G.jsxs("li",{className:"card sm:flex-row sm:items-center",children:[G.jsx("img",{src:T.photoURL||"/vite.svg",alt:"avatar",className:"w-12 h-12 rounded-full"}),G.jsxs("div",{className:"flex-1",children:[G.jsx("p",{className:"font-semibold",children:T.name||T.email}),G.jsx("p",{className:"text-sm text-gray-600",children:T.email})]}),G.jsxs("select",{value:T.role,onChange:A=>_(T.userId,T.email,A.target.value),className:"border rounded px-2 py-1",children:[G.jsx("option",{value:"Vendedor",children:"Vendedor"}),G.jsx("option",{value:"Administrador",children:"Administrador"})]}),T.userId&&G.jsx("button",{onClick:()=>f(e.find(A=>A.id===T.userId)),title:"Editar nombre",children:G.jsx("img",{src:vh,alt:"editar",className:"icon"})}),G.jsx("button",{onClick:()=>y(T.email),className:"bg-red-500 text-white px-2 py-1 rounded",children:"Eliminar"})]},T.email))})]}),a&&G.jsx(Oo,{onClose:()=>l(!1),children:G.jsx(QN,{onDone:()=>{l(!1),p()}})}),c&&G.jsx(Oo,{onClose:()=>f(null),children:G.jsx(XN,{user:c,onDone:()=>{f(null),p()}})})]})}function $N(){const{login:i}=nd();return G.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:G.jsxs("div",{className:"bg-white p-6 rounded shadow text-center space-y-4",children:[G.jsx("img",{src:"/assets/logo.png",alt:"Claus Vende",className:"h-12 mx-auto"}),G.jsx("h2",{className:"text-xl font-semibold text-gray-700",children:"Ingresa"}),G.jsx("button",{onClick:i,className:"bg-blue-900 text-white px-4 py-2 rounded",children:"Iniciar sesión con Google"})]})})}function JN({page:i,setPage:t}){const{user:e,role:r,logout:a}=nd(),[l,c]=me.useState(!1);if(!e)return G.jsx($N,{});const f=T=>{const A=T?T.trim().split(/\s+/):[];return A.length<=2?{nombres:A[0]||"",apellidos:A.slice(1).join(" ")}:{nombres:A.slice(0,A.length-2).join(" "),apellidos:A.slice(A.length-2).join(" ")}},{nombres:p,apellidos:y}=f(e.displayName),_=(T,A=null)=>{(T==="finance"||T==="users")&&r!=="Administrador"||(t({name:T,clientId:A}),c(!1))};let S;switch(i.name){case"clients":S=G.jsx(Uv,{go:_});break;case"sales":S=G.jsx(KN,{});break;case"finance":S=r==="Administrador"?G.jsx(YN,{}):G.jsx("p",{className:"text-center",children:"Acceso restringido"});break;case"users":S=r==="Administrador"?G.jsx(WN,{}):G.jsx("p",{className:"text-center",children:"Acceso restringido"});break;case"client":S=G.jsx(zN,{id:i.clientId,go:_});break;default:S=G.jsx(Uv,{go:_})}return G.jsxs("div",{className:"flex min-h-screen bg-gray-100",children:[l&&G.jsx("div",{className:"fixed inset-0 bg-black/50 md:hidden z-10",onClick:()=>c(!1)}),G.jsxs("aside",{className:`bg-blue-900 text-white w-60 p-4 space-y-2 fixed inset-y-0 left-0 transform ${l?"translate-x-0":"-translate-x-full"} transition-transform md:relative md:translate-x-0 z-20`,children:[G.jsx("button",{className:"md:hidden absolute top-2 right-2 text-2xl",onClick:()=>c(!1),children:"×"}),G.jsx("h1",{className:"text-lg font-semibold mb-4 text-center",children:"Menú"}),G.jsxs("nav",{className:"flex flex-col gap-2",children:[G.jsxs("button",{onClick:()=>_("sales"),className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-blue-500 text-left group",children:[G.jsx("svg",{className:"w-5 h-5 text-current group-hover:text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:G.jsx("path",{d:"M2.25 2.25a.75.75 0 000 1.5h1.386c.17 0 .318.114.362.278l2.558 9.592a3.752 3.752 0 00-2.806 3.63c0 .414.336.75.75.75h15.75a.75.75 0 000-1.5H5.378A2.25 2.25 0 017.5 15h11.218a.75.75 0 00.674-.421 60.358 60.358 0 002.96-7.228.75.75 0 00-.525-.965A60.864 60.864 0 005.68 4.509l-.232-.867A1.875 1.875 0 003.636 2.25H2.25zM3.75 20.25a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0zM16.5 20.25a1.5 1.5 0 113 0 1.5 1.5 0 01-3 0z"})}),"Ventas"]}),G.jsxs("button",{onClick:()=>_("clients"),className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-blue-500 text-left group",children:[G.jsxs("svg",{className:"w-5 h-5 text-current group-hover:text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:[G.jsx("path",{"fill-rule":"evenodd",d:"M8.25 6.75a3.75 3.75 0 117.5 0 3.75 3.75 0 01-7.5 0zM15.75 9.75a3 3 0 116 0 3 3 0 01-6 0zM2.25 9.75a3 3 0 116 0 3 3 0 01-6 0zM6.31 15.117A6.745 6.745 0 0112 12a6.745 6.745 0 016.709 7.498.75.75 0 01-.372.568A12.696 12.696 0 0112 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 01-.372-.568 6.787 6.787 0 011.019-4.38z","clip-rule":"evenodd"}),G.jsx("path",{d:"M5.082 14.254a8.287 8.287 0 00-1.308 5.135 9.687 9.687 0 01-1.764-.44l-.115-.04a.563.563 0 01-.373-.487l-.01-.121a3.75 3.75 0 013.57-4.047zM20.226 19.389a8.287 8.287 0 00-1.308-5.135 3.75 3.75 0 013.57 4.047l-.01.121a.563.563 0 01-.373.486l-.115.04c-.567.2-1.156.349-1.764.441z"})]}),"Clientes"]}),r==="Administrador"&&G.jsxs(G.Fragment,{children:[G.jsxs("button",{onClick:()=>_("finance"),className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-blue-500 text-left group",children:[G.jsxs("svg",{className:"w-5 h-5 text-current group-hover:text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:[G.jsx("path",{d:"M10.464 8.746c.227-.18.497-.311.786-.394v2.795a2.252 2.252 0 01-.786-.393c-.394-.313-.546-.681-.546-1.004 0-.323.152-.691.546-1.004zM12.75 15.662v-2.824c.347.085.664.228.921.421.427.32.579.686.579.991 0 .305-.152.671-.579.991a2.534 2.534 0 01-.921.42z"}),G.jsx("path",{"fill-rule":"evenodd",d:"M12 2.25c-5.385 0-9.75 4.365-9.75 9.75s4.365 9.75 9.75 9.75 9.75-4.365 9.75-9.75S17.385 2.25 12 2.25zM12.75 6a.75.75 0 00-1.5 0v.816a3.836 3.836 0 00-1.72.756c-.712.566-1.112 1.35-1.112 2.178 0 .829.4 1.612 1.113 2.178.502.4 1.102.647 1.719.756v2.978a2.536 2.536 0 01-.921-.421l-.879-.66a.75.75 0 00-.9 1.2l.879.66c.533.4 1.169.645 1.821.75V18a.75.75 0 001.5 0v-.81a4.124 4.124 0 001.821-.749c.745-.559 1.179-1.344 1.179-2.191 0-.847-.434-1.632-1.179-2.191a4.122 4.122 0 00-1.821-.75V8.354c.29.082.559.213.786.393l.415.33a.75.75 0 00.933-1.175l-.415-.33a3.836 3.836 0 00-1.719-.755V6z","clip-rule":"evenodd"})]}),"Finanzas"]}),G.jsxs("button",{onClick:()=>_("users"),className:"flex items-center gap-2 px-3 py-2 rounded hover:bg-blue-500 text-left group",children:[G.jsx("svg",{className:"w-5 h-5 text-current group-hover:text-white",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true",children:G.jsx("path",{d:"M15.75 9A3.75 3.75 0 1112 5.25 3.75 3.75 0 0115.75 9zm-7.5 0A3.75 3.75 0 115 5.25 3.75 3.75 0 018.25 9zM3 20.25a8.25 8.25 0 1118 0v1.5H3v-1.5z"})}),"Usuarios"]})]})]})]}),G.jsxs("div",{className:"flex-1 flex flex-col",children:[G.jsxs("header",{className:"fixed top-0 left-0 right-0 md:left-60 md:right-4 bg-white shadow",children:[G.jsx("div",{className:"px-4 py-2 text-center",children:G.jsx("img",{src:"/assets/logo.png",alt:"Claus Vende",className:"h-8 mx-auto"})}),G.jsxs("div",{className:"flex items-center justify-between px-4 py-2 border-t",children:[G.jsxs("div",{className:"flex items-center gap-2",children:[G.jsx("button",{className:"md:hidden text-2xl mr-2",onClick:()=>c(!l),children:"☰"}),G.jsxs("div",{className:"flex items-center gap-2",children:[G.jsx("img",{src:e.photoURL,alt:"avatar",className:"w-8 h-8 rounded-full"}),G.jsxs("div",{className:"leading-tight",children:[G.jsx("p",{className:"font-semibold leading-tight md:hidden",children:p}),G.jsx("p",{className:"font-semibold leading-tight md:hidden",children:y}),G.jsx("p",{className:"font-semibold leading-none hidden md:block",children:e.displayName}),G.jsx("p",{className:"text-xs text-gray-700",children:r})]})]})]}),G.jsx("button",{onClick:a,className:"bg-red-500 text-white px-3 py-1 rounded",children:"Cerrar sesión"})]})]}),G.jsx("main",{className:"p-4 pt-36 md:pt-36 flex-1",children:S})]})]})}function ZN(){const[i,t]=me.useState({name:"clients"});return G.jsx(Ux,{children:G.jsx(JN,{page:i,setPage:t})})}z4.createRoot(document.getElementById("root")).render(G.jsx(me.StrictMode,{children:G.jsx(ZN,{})}));export{kn as _};
